<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <script src="https://unpkg.com/@descope/web-component@latest/dist/index.js"></script>
</head>
<body style="background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0;">

    <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        
        <descope-wc 
            project-id="{{ project_id }}" 
            flow-id="{{ flow_id }}"
            redirect-url="{{ login_url }}"
            state="{{ state }}"
            theme="light"
        ></descope-wc>

    </div>

    <script>
        const descopeWc = document.querySelector('descope-wc');
        
        const onSuccess = (e) => {
            console.log("Login Success! Redirecting...", e.detail);
            const sessionToken = e.detail.sessionJwt;
            
            // Redirect to the FINAL destination (your Python callback)
            window.location.href = "{{ callback_url }}?session_token=" + sessionToken;
        };

        const onError = (err) => {
            console.error("Login Error:", err);
            alert("Login failed. Check console for details.");
        }

        descopeWc.addEventListener('success', onSuccess);
        descopeWc.addEventListener('error', onError);
    </script>
</body>
</html>